{% extends 'admin_base.html' %}
{% block title %}Offers{% endblock %}
{% block page_title %}Offer Management{% endblock %}

{% block content %}
<div class="p-6">

    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-semibold text-gray-800">Offer Management</h2>
        <a href="{% url 'add_offer' %}" class="btn-blue"><i class="fas fa-plus mr-1"></i>Add Offer</a>
    </div>

    <!-- Filters -->
    <div class="bg-white p-5 rounded-xl shadow-sm mb-6">
        <form method="GET" class="grid grid-cols-1 md:grid-cols-3 gap-4">

            <div>
                <label class="text-sm font-medium text-gray-700">Search</label>
                <input type="text" name="search" class="input-field" value="{{ search_query }}">
            </div>

            <div>
                <label class="text-sm font-medium text-gray-700">Status</label>
                <select name="status" class="input-field">
                    <option value="">All</option>
                    <option value="active" {% if status_filter == 'active' %}selected{% endif %}>Active</option>
                    <option value="inactive" {% if status_filter == 'inactive' %}selected{% endif %}>Inactive</option>
                    <option value="expired" {% if status_filter == 'expired' %}selected{% endif %}>Expired</option>
                </select>
            </div>

            <div class="flex items-end">
                <button class="btn-blue w-full">Filter</button>
            </div>

        </form>
    </div>

    <!-- Table -->
    <div class="bg-white p-6 rounded-xl shadow-sm">
        {% if offers %}
        <div class="overflow-x-auto">
            <table class="table-auto w-full text-left">
                <thead class="bg-gray-50 text-gray-600 text-sm uppercase">
                    <tr>
                        <th class="px-4 py-3">Name</th>
                        <th class="px-4 py-3">Category</th>
                        <th class="px-4 py-3">Discount</th>
                        <th class="px-4 py-3">Duration</th>
                        <th class="px-4 py-3">Status</th>
                        <th class="px-4 py-3">Products</th>
                        <th class="px-4 py-3">Actions</th>
                    </tr>
                </thead>

                <tbody>
                    {% for offer in offers %}
                    <tr class="border-b hover:bg-gray-50">
                        <td class="px-4 py-3">{{ offer.name }}</td>
                        <td class="px-4 py-3">{{ offer.category.category_name }}</td>
                        <td class="px-4 py-3">{{ offer.discount }}%</td>
                        <td class="px-4 py-3 text-sm">{{ offer.start_date }} â†’ {{ offer.end_date }}</td>

                        <td class="px-4 py-3">
                            {% if offer.is_active %}
                                <span class="badge-success">Active</span>
                            {% elif offer.status == 'expired' %}
                                <span class="badge-danger">Expired</span>
                            {% else %}
                                <span class="badge-warning">Inactive</span>
                            {% endif %}
                        </td>

                        <td class="px-4 py-3">{{ offer.products.count }}</td>

                        <td class="px-4 py-3 flex gap-2">
                            <a href="{% url 'edit_offer' offer.id %}" class="btn-sm-yellow"><i class="fas fa-edit"></i></a>
                            <a href="{% url 'delete_offer' offer.id %}" onclick="return confirm('Delete this offer?')" class="btn-sm-red"><i class="fas fa-trash"></i></a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
        {% else %}
        <p class="text-center text-gray-500 py-6">No offers found.</p>
        {% endif %}
    </div>

</div>
{% endblock %}
