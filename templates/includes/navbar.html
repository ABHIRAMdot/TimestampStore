<!-- navbar.html -->
<header class="sticky top-0 z-50 bg-white shadow-sm">
    <div class="container mx-auto px-4 py-4">
        <div class="flex justify-between items-center">
            <div class="text-2xl font-bold">
                <a href="{% url 'home' %}" class="hover:text-secondary transition">TimeStamp</a>
            </div>
            
            <nav class="hidden md:flex space-x-8">
                <!-- Shop Dropdown -->
                <div class="relative group">
                    <button class="font-medium hover:text-secondary transition flex items-center">
                        Shop <i class="fas fa-chevron-down ml-1 text-xs"></i>
                    </button>

                    <div class="absolute left-0 mt-2 bg-white shadow-lg rounded-md py-4 px-6 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50 w-56">
                        {% for main in main_categories %}
                            <div class="mb-4">
                                <a href="{% url 'user_product_list' %}?main={{ main.slug }}" class="font-semibold block hover:text-secondary">
                                    {{ main.category_name }}
                                </a>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                <a href="#" class="font-medium hover:text-secondary transition">About</a>
                <a href="#" class="font-medium hover:text-secondary transition">Journal</a>
                <a href="#" class="font-medium hover:text-secondary transition">Contact Us</a>
            </nav>

            <div class="flex items-center space-x-6">
                <div class="hidden md:flex items-center space-x-4 text-sm">
                    <!-- Search Bar (Expands on hover) -->
                    <div class="group flex items-center bg-gray-100 rounded-lg px-3 py-2 transition-all duration-300 hover:bg-gray-200">
                        <form action="{% url 'user_product_list' %}" method="GET" class="flex items-center">
                            <input 
                                type="text" 
                                name="search"
                                placeholder="Search..." 
                                class="bg-transparent focus:outline-none w-20 group-hover:w-32 transition-all duration-300 text-sm"
                            >
                            <button type="submit" class="text-gray-500 hover:text-secondary ml-2">
                                <i class="fas fa-search"></i>
                            </button>
                        </form>
                    </div>
            
                    <!-- Cart -->
                    <div class="relative">
                        <a href="#" class="fas fa-shopping-bag cursor-pointer hover:text-secondary transition"></a>
                        <span class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">0</span>
                    </div>
            
                    <!-- User Profile or Login -->
                    {% if user.is_authenticated %}
                        <!-- Logged In User Dropdown -->
                        <div class="relative group">
                            <button class="flex items-center space-x-2 hover:text-secondary transition">
                                <i class="fas fa-user-circle text-xl"></i>
                                <span class="font-medium">{{ user.first_name }}</span>
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>

                            <!-- Dropdown Menu -->
                            <div class="absolute right-0 mt-2 w-48 bg-white shadow-lg rounded-md py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
                                <a href="{% url 'profile' %}" class="block px-4 py-2 hover:bg-gray-100 transition">
                                    <i class="fas fa-user mr-2"></i>My Profile
                                </a>
                                <a href="#" class="block px-4 py-2 hover:bg-gray-100 transition">
                                    <i class="fas fa-box mr-2"></i>My Orders
                                </a>
                                <a href="#" class="block px-4 py-2 hover:bg-gray-100 transition">
                                    <i class="fas fa-heart mr-2"></i>Wishlist
                                </a>
                                <a href="#" class="block px-4 py-2 hover:bg-gray-100 transition">
                                    <i class="fas fa-cog mr-2"></i>Settings
                                </a>
                                <hr class="my-2">
                                <a href="{% url 'logout' %}" class="block px-4 py-2 text-red-600 hover:bg-gray-100 transition">
                                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                                </a>
                            </div>
                        </div>
                    {% else %}
                        <!-- Not Logged In - Show Login/Signup -->
                        <div class="flex items-center space-x-3">
                            <a href="{% url 'login' %}" class="font-medium hover:text-secondary transition">
                                Login
                            </a>
                            <span class="text-gray-300">|</span>
                            <a href="{% url 'register' %}" class="px-4 py-2 bg-secondary text-white rounded-lg hover:bg-opacity-90 transition font-medium">
                                Sign Up
                            </a>
                        </div>
                    {% endif %}
                </div>
                
                <!-- Mobile Menu Button -->
                <button class="md:hidden" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden md:hidden mt-4 pb-4 border-t pt-4">
            <div class="flex flex-col space-y-4">
                <!-- Search -->
                <form action="{% url 'user_product_list' %}" method="GET" class="flex items-center bg-gray-100 rounded-lg px-3 py-2">
                    <input 
                        type="text" 
                        name="search"
                        placeholder="Search..." 
                        class="bg-transparent focus:outline-none w-full text-sm"
                    >
                    <button type="submit" class="text-gray-500 hover:text-secondary ml-2">
                        <i class="fas fa-search"></i>
                    </button>
                </form>

                <!-- Navigation Links -->
                <a href="{% url 'user_product_list' %}" class="font-medium hover:text-secondary transition">Shop</a>
                <a href="#" class="font-medium hover:text-secondary transition">About</a>
                <a href="#" class="font-medium hover:text-secondary transition">Journal</a>
                <a href="#" class="font-medium hover:text-secondary transition">Contact Us</a>
                
                <!-- Cart -->
                <a href="#" class="flex items-center font-medium hover:text-secondary transition">
                    <i class="fas fa-shopping-bag mr-2"></i> Cart (0)
                </a>

                {% if user.is_authenticated %}
                    <!-- User Menu Mobile -->
                    <div class="border-t pt-4 mt-4">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-10 h-10 rounded-full bg-secondary text-white flex items-center justify-center">
                                <i class="fas fa-user text-lg"></i>
                            </div>
                            <div>
                                <p class="font-semibold">{{ user.first_name }} {{ user.last_name }}</p>
                                <p class="text-xs text-gray-500">{{ user.email }}</p>
                            </div>
                        </div>
                        <a href="#" class="block py-2 hover:text-secondary transition">
                            <i class="fas fa-user mr-2"></i>My Profile
                        </a>
                        <a href="#" class="block py-2 hover:text-secondary transition">
                            <i class="fas fa-box mr-2"></i>My Orders
                        </a>
                        <a href="#" class="block py-2 hover:text-secondary transition">
                            <i class="fas fa-heart mr-2"></i>Wishlist
                        </a>
                        <a href="#" class="block py-2 hover:text-secondary transition">
                            <i class="fas fa-cog mr-2"></i>Settings
                        </a>

            <!-- do something in here later for the button  -->
                    <form action="" method="post">
                        
                        <a href="{% url 'logout' %}" class="block py-2 text-red-600 hover:text-red-700 transition"><button type="submit">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </button>
                        </a>

                    </form>
                    </div>
                {% else %}
                    <!-- Login/Signup Mobile -->
                    <div class="border-t pt-4 mt-4 space-y-3">
                        <a href="{% url 'login' %}" class="block w-full py-2 px-4 border border-secondary text-secondary rounded-lg hover:bg-secondary hover:text-white transition text-center font-medium">
                            Login
                        </a>
                        <a href="{% url 'register' %}" class="block w-full py-2 px-4 bg-secondary text-white rounded-lg hover:bg-opacity-90 transition text-center font-medium">
                            Sign Up
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</header>

<script>
function toggleMobileMenu() {
    const menu = document.getElementById('mobileMenu');
    menu.classList.toggle('hidden');
}
</script>